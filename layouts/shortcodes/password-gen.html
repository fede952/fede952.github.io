<div class="pg-container">
    <div class="pg-card">
        <div class="pg-input-group">
            <input type="text" id="pg-password" readonly placeholder="Your Secure Password">
            <button id="pg-copy-btn" title="Copy to clipboard">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
            </button>
        </div>

        <div class="pg-strength-meter">
            <div class="pg-strength-bar" id="pg-strength-bar"></div>
            <span id="pg-strength-text">Strength: Low</span>
        </div>

        <div class="pg-controls">
            <div class="pg-control-row">
                <label>Length: <span id="pg-length-val">16</span></label>
                <input type="range" id="pg-length" min="8" max="64" value="16">
            </div>

            <div class="pg-options">
                <label class="pg-checkbox"><input type="checkbox" id="pg-uppercase" checked> ABC</label>
                <label class="pg-checkbox"><input type="checkbox" id="pg-lowercase" checked> abc</label>
                <label class="pg-checkbox"><input type="checkbox" id="pg-numbers" checked> 123</label>
                <label class="pg-checkbox"><input type="checkbox" id="pg-symbols" checked> !@#</label>
            </div>
        </div>

        <button id="pg-generate-btn">Generate Password</button>

        <p class="pg-security-note">ðŸ”’ <strong>Client-Side Security:</strong> Generated locally using <code>crypto.getRandomValues()</code>. No data leaves your browser.</p>
    </div>
</div>

<style>
/* CSS ISOLATO E SPECIFICO */
.pg-container {
    margin: 2rem 0;
    width: 100%;
    display: flex;
    justify-content: center;
}
.pg-card {
    background: #1d1e20; /* Colore scuro del tema */
    border: 1px solid #333;
    border-radius: 12px;
    padding: 2rem;
    width: 100%;
    max-width: 500px;
    box-shadow: 0 4px 20px rgba(0,0,0,0.3);
}
.pg-input-group {
    display: flex; /* FLEXBOX RISOLVE IL POSIZIONAMENTO */
    margin-bottom: 1.5rem;
    position: relative;
    border: 1px solid #444;
    border-radius: 8px;
    background: #111;
    overflow: hidden;
}
.pg-input-group input {
    flex-grow: 1; /* Occupa tutto lo spazio disponibile */
    background: transparent;
    border: none;
    color: #0f0; /* Verde Hacker */
    font-family: 'JetBrains Mono', monospace;
    font-size: 1.2rem;
    padding: 1rem;
    outline: none;
}
.pg-input-group button {
    background: #333;
    border: none;
    border-left: 1px solid #444;
    color: white;
    cursor: pointer;
    padding: 0 1.2rem;
    transition: background 0.2s;
    display: flex;
    align-items: center;
    justify-content: center;
}
.pg-input-group button:hover { background: #444; }
.pg-input-group button:active { background: #0f0; color: #000; }

.pg-strength-meter { margin-bottom: 1.5rem; }
.pg-strength-bar { height: 4px; background: #333; border-radius: 2px; width: 100%; overflow: hidden; position: relative; }
.pg-strength-bar::after { content: ''; position: absolute; left: 0; top: 0; height: 100%; width: 0%; transition: width 0.3s, background 0.3s; id: "pg-bar-fill"; }
#pg-strength-text { font-size: 0.8rem; color: #888; margin-top: 5px; display: block; }

.pg-controls { margin-bottom: 1.5rem; }
.pg-control-row { margin-bottom: 1rem; }
.pg-control-row input[type="range"] { width: 100%; cursor: pointer; }
.pg-options { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
.pg-checkbox { display: flex; align-items: center; gap: 8px; cursor: pointer; user-select: none; }

#pg-generate-btn {
    width: 100%;
    padding: 1rem;
    background: #007bff; /* O il colore accent del tuo sito */
    color: white;
    border: none;
    border-radius: 8px;
    font-size: 1rem;
    font-weight: bold;
    cursor: pointer;
    transition: transform 0.1s;
}
#pg-generate-btn:active { transform: scale(0.98); }

.pg-security-note { font-size: 0.8rem; color: #666; margin-top: 1.5rem; text-align: center; line-height: 1.4; border-top: 1px solid #333; padding-top: 1rem; }
code { background: #222; padding: 2px 4px; border-radius: 4px; color: #aaa; }
</style>

<script>
// Logica JS inclusa (Generazione sicura, listener, strength check)
document.addEventListener('DOMContentLoaded', function() {
    const chars = {
        upper: 'ABCDEFGHIJKLMNOPQRSTUVWXYZ',
        lower: 'abcdefghijklmnopqrstuvwxyz',
        numbers: '0123456789',
        symbols: '!@#$%^&*()_+~`|}{[]:;?><,./-='
    };

    const els = {
        pass: document.getElementById('pg-password'),
        copy: document.getElementById('pg-copy-btn'),
        gen: document.getElementById('pg-generate-btn'),
        len: document.getElementById('pg-length'),
        lenVal: document.getElementById('pg-length-val'),
        bar: document.getElementById('pg-strength-bar'),
        text: document.getElementById('pg-strength-text'),
        opts: {
            upper: document.getElementById('pg-uppercase'),
            lower: document.getElementById('pg-lowercase'),
            numbers: document.getElementById('pg-numbers'),
            symbols: document.getElementById('pg-symbols')
        }
    };

    function generate() {
        let charset = '';
        if (els.opts.upper.checked) charset += chars.upper;
        if (els.opts.lower.checked) charset += chars.lower;
        if (els.opts.numbers.checked) charset += chars.numbers;
        if (els.opts.symbols.checked) charset += chars.symbols;

        if (charset === '') return;

        const length = parseInt(els.len.value);
        let password = '';
        const randomValues = new Uint32Array(length);
        window.crypto.getRandomValues(randomValues);

        for (let i = 0; i < length; i++) {
            password += charset[randomValues[i] % charset.length];
        }

        els.pass.value = password;
        updateStrength(password);
    }

    function updateStrength(pw) {
        let strength = 0;
        if (pw.length >= 12) strength += 1;
        if (pw.length >= 16) strength += 1;
        if (/[A-Z]/.test(pw)) strength += 1;
        if (/[0-9]/.test(pw)) strength += 1;
        if (/[^A-Za-z0-9]/.test(pw)) strength += 1;

        const colors = ['#f00', '#ff4500', '#ffa500', '#9acd32', '#0f0'];
        const width = Math.min(100, (strength / 5) * 100);

        els.bar.style.background = `linear-gradient(90deg, ${colors[Math.min(strength, 4)]} ${width}%, #333 ${width}%)`;
        els.text.innerText = strength < 3 ? 'Weak' : (strength < 5 ? 'Good' : 'Strong');
    }

    els.len.addEventListener('input', (e) => {
        els.lenVal.innerText = e.target.value;
        generate();
    });

    Object.values(els.opts).forEach(opt => opt.addEventListener('change', generate));
    els.gen.addEventListener('click', generate);

    els.copy.addEventListener('click', () => {
        els.pass.select();
        document.execCommand('copy');
        const originalIcon = els.copy.innerHTML;
        els.copy.innerHTML = 'âœ…';
        setTimeout(() => els.copy.innerHTML = originalIcon, 2000);
    });

    generate(); // Init
});
</script>
